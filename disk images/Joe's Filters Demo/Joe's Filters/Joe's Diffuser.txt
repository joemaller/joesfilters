//                         v3.5 //	                  //	   wvwwvwvww    //	   \                  /  //	     \______/  //	                          	//       Joe's Filters     //   for Final Cut Pro // (C) 2002 Joe Maller// http://www.joesfilters.com// http://www.fxscriptreference.orgfilter "Joe's Diffuser";group "Joe's Blur Filters";input BlurVal, "Blur", slider, 10, 0, 50;input ApplyAs, "Mode", Popup, 1, "Normal", "Multiply", "Screen", "Overlay", "Lighten", "Darken", "Add", "Subtract", "Difference";input Opacity, "Opacity", slider, 40, 0, 100;input label1, "Adjust", Label,"";input inBlack, "Input Black", slider, 15, 0, 253;input inWhite, "Input White", slider, 230, 2, 255;input outBlack, "Output Black", slider, 0, 0,  255;input outWhite, "Output White", slider, 255, 0, 255;input title, "Joe's Filters", Label,"";input title1, "www.joesfilters.com", Label,"";codefloat w, h, i, adjKey[256];dimensionsOf(Dest, w, h);float zoomfactor; zoomfactor = w/720;image xbuffer[w][h];for i = 0 to 255	adjKey[i] = (i < inWhite) ? (i-inBlack)/(inWhite-inBlack) : 1; next;adjKey *= outWhite - outBlack;	adjKey += outBlack;	adjKey /= 255;levelMap(src1, xbuffer, LinearRamp, adjKey, adjKey, adjKey);BlurChannel(xbuffer, dest, BlurVal, 1, 1, 1, 1, aspectOf(dest));	if ApplyAs == 1; Matte(dest, src1, dest, opacity/100, kalpha); end ifif ApplyAs == 2; Multiply(src1, dest, dest, opacity/100, kalpha); end ifif ApplyAs == 3; Screen(src1, dest, dest, opacity/100, kalpha); end ifif ApplyAs == 4; Overlay(src1, dest, dest, opacity/100, kalpha); end ifif ApplyAs == 5; Lighten(src1, dest, dest, opacity/100, kalpha); end ifif ApplyAs == 6; Darken(src1, dest, dest, opacity/100, kalpha); end ifif ApplyAs == 7; add(src1, dest, dest, opacity/100, kalpha); end if;if ApplyAs == 8; 		subtract(src1, dest, dest, opacity/100, kalpha);		ChannelCopy(src1, dest, kalpha, knone, knone, knone);  end if;if ApplyAs == 9; 		Difference(src1, dest, dest, kalpha); 		ChannelCopy(src1, dest, kalpha, knone, knone, knone); 		Matte(dest, src1,  dest, opacity/100, knone); end if;